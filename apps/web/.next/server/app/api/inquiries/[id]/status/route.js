"use strict";(()=>{var e={};e.id=306,e.ids=[306],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},95574:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>x,requestAsyncStorage:()=>f,routeModule:()=>l,serverHooks:()=>v,staticGenerationAsyncStorage:()=>w});var n={};r.r(n),r.d(n,{PUT:()=>p,runtime:()=>c});var i=r(37260),s=r(71827),a=r(2150),o=r(80643),u=r(87347),d=r(105);let c="nodejs";async function p(e,{params:t}){try{let r=e.cookies.get("auth-token")?.value;if(!r||!(0,d.WX)(r))return o.NextResponse.json({error:"Unauthorized"},{status:401});let{status:n}=await e.json();if(!["new","contacted","closed"].includes(n))return o.NextResponse.json({error:"Invalid status"},{status:400});if(!await (0,u.z3)(t.id,n))return o.NextResponse.json({error:"Inquiry not found or update failed"},{status:404});return o.NextResponse.json({success:!0})}catch(e){return console.error("Update inquiry status error:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/inquiries/[id]/status/route",pathname:"/api/inquiries/[id]/status",filename:"route",bundlePath:"app/api/inquiries/[id]/status/route"},resolvedPagePath:"/workspace/apps/web/app/api/inquiries/[id]/status/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:w,serverHooks:v}=l,m="/api/inquiries/[id]/status/route";function x(){return(0,a.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:w})}},105:(e,t,r)=>{r.d(t,{Qj:()=>d,RA:()=>c,WX:()=>p});var n=r(63337),i=r(57772),s=r.n(i),a=r(41207),o=r.n(a);let u=process.env.JWT_SECRET||"dev-secret-key";async function d(e,t){let r=(await (0,n.N)()).collection("admins"),i=await r.findOne({email:e});return i&&await s().compare(t,i.password)?{...i,_id:i._id.toString()}:null}function c(e){let t={expiresIn:process.env.JWT_EXPIRES_IN||"7d"};return o().sign({adminId:e},u,t)}function p(e){try{return{adminId:o().verify(e,u).adminId}}catch{return null}}},87347:(e,t,r)=>{r.d(t,{a6:()=>a,ks:()=>s,z3:()=>o});var n=r(63337),i=r(38013);async function s(e){let t=(await (0,n.N)()).collection("inquiries"),r=new Date,i={...e,channel:e.channel||"website",status:"new",createdAt:r,updatedAt:r},s=await t.insertOne(i);return{...i,_id:s.insertedId.toString()}}async function a(e){let t=(await (0,n.N)()).collection("inquiries");return(await t.find(e?{status:e}:{}).sort({createdAt:-1}).toArray()).map(e=>({...e,_id:e._id.toString()}))}async function o(e,t){let r=(await (0,n.N)()).collection("inquiries");return(await r.updateOne({_id:new i.ObjectId(e)},{$set:{status:t,updatedAt:new Date}})).modifiedCount>0}},63337:(e,t,r)=>{r.d(t,{N:()=>o});var n=r(38013);let i=process.env.MONGODB_URI,s={},a=null;async function o(){return(await function(){if(!i)throw Error("Please define the MONGODB_URI environment variable");return a||(a=new n.MongoClient(i,s).connect()),a}()).db("kayo")}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[483,592,242],()=>r(95574));module.exports=n})();