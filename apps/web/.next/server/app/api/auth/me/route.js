"use strict";(()=>{var e={};e.id=788,e.ids=[788],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},476:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>w,requestAsyncStorage:()=>f,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>v});var n={};t.r(n),t.d(n,{GET:()=>l,dynamic:()=>c});var o=t(37260),a=t(71827),i=t(2150),s=t(80643),u=t(105),d=t(63337),p=t(38013);let c="force-dynamic";async function l(e){try{let r=e.cookies.get("auth-token")?.value;if(!r)return s.NextResponse.json({error:"No token provided"},{status:401});let t=(0,u.WX)(r);if(!t)return s.NextResponse.json({error:"Invalid token"},{status:401});let n=await (0,d.N)(),o=await n.collection("admins").findOne({_id:new p.ObjectId(t.adminId)},{projection:{password:0}});if(!o)return s.NextResponse.json({error:"Admin not found"},{status:404});return s.NextResponse.json({admin:{id:o._id.toString(),email:o.email,name:o.name,role:o.role}})}catch(e){return console.error("Auth check error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/me/route",pathname:"/api/auth/me",filename:"route",bundlePath:"app/api/auth/me/route"},resolvedPagePath:"/workspace/apps/web/app/api/auth/me/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:v,serverHooks:h}=m,x="/api/auth/me/route";function w(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:v})}},105:(e,r,t)=>{t.d(r,{Qj:()=>d,RA:()=>p,WX:()=>c});var n=t(63337),o=t(57772),a=t.n(o),i=t(41207),s=t.n(i);let u=process.env.JWT_SECRET||"dev-secret-key";async function d(e,r){let t=(await (0,n.N)()).collection("admins"),o=await t.findOne({email:e});return o&&await a().compare(r,o.password)?{...o,_id:o._id.toString()}:null}function p(e){let r={expiresIn:process.env.JWT_EXPIRES_IN||"7d"};return s().sign({adminId:e},u,r)}function c(e){try{return{adminId:s().verify(e,u).adminId}}catch{return null}}},63337:(e,r,t)=>{t.d(r,{N:()=>s});var n=t(38013);let o=process.env.MONGODB_URI,a={},i=null;async function s(){return(await function(){if(!o)throw Error("Please define the MONGODB_URI environment variable");return i||(i=new n.MongoClient(o,a).connect()),i}()).db("kayo")}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[483,592,242],()=>t(476));module.exports=n})();