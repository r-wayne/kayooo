"use strict";(()=>{var e={};e.id=668,e.ids=[668],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},68231:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>x,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>v});var n={};r.r(n),r.d(n,{GET:()=>d,PUT:()=>l,dynamic:()=>c});var s=r(37260),o=r(71827),a=r(2150),i=r(80643),u=r(105),p=r(63337);let c="force-dynamic";async function d(e){try{let t=e.cookies.get("auth-token")?.value;if(!t||!(0,u.WX)(t))return i.NextResponse.json({error:"Unauthorized"},{status:401});let r=await (0,p.N)(),n=await r.collection("settings").findOne({type:"company"});return i.NextResponse.json({settings:n||{company_email:process.env.FROM_EMAIL||"",whatsapp_number:process.env.WHATSAPP_NUMBER||"",phone:"",address:"",social_links:{facebook:"",twitter:"",instagram:"",linkedin:""}}})}catch(e){return console.error("Get settings error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function l(e){try{let t=e.cookies.get("auth-token")?.value;if(!t||!(0,u.WX)(t))return i.NextResponse.json({error:"Unauthorized"},{status:401});let r=await e.json(),n=await (0,p.N)();return await n.collection("settings").updateOne({type:"company"},{$set:{...r,type:"company",updatedAt:new Date}},{upsert:!0}),i.NextResponse.json({success:!0})}catch(e){return console.error("Update settings error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/settings/route",pathname:"/api/settings",filename:"route",bundlePath:"app/api/settings/route"},resolvedPagePath:"/workspace/apps/web/app/api/settings/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:f}=m,y="/api/settings/route";function x(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:v})}},105:(e,t,r)=>{r.d(t,{Qj:()=>p,RA:()=>c,WX:()=>d});var n=r(63337),s=r(57772),o=r.n(s),a=r(41207),i=r.n(a);let u=process.env.JWT_SECRET||"dev-secret-key";async function p(e,t){let r=(await (0,n.N)()).collection("admins"),s=await r.findOne({email:e});return s&&await o().compare(t,s.password)?{...s,_id:s._id.toString()}:null}function c(e){let t={expiresIn:process.env.JWT_EXPIRES_IN||"7d"};return i().sign({adminId:e},u,t)}function d(e){try{return{adminId:i().verify(e,u).adminId}}catch{return null}}},63337:(e,t,r)=>{r.d(t,{N:()=>i});var n=r(38013);let s=process.env.MONGODB_URI,o={},a=null;async function i(){return(await function(){if(!s)throw Error("Please define the MONGODB_URI environment variable");return a||(a=new n.MongoClient(s,o).connect()),a}()).db("kayo")}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[483,592,242],()=>r(68231));module.exports=n})();