"use strict";(()=>{var e={};e.id=556,e.ids=[556],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},31861:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>N,patchFetch:()=>j,requestAsyncStorage:()=>w,routeModule:()=>f,serverHooks:()=>y,staticGenerationAsyncStorage:()=>v});var n={};t.r(n),t.d(n,{DELETE:()=>x,GET:()=>p,PUT:()=>l,runtime:()=>d});var o=t(37260),i=t(71827),a=t(2150),s=t(80643),u=t(23347),c=t(105);let d="nodejs";async function p(e,{params:r}){try{let e=await (0,u.BJ)(r.id);if(!e)return s.NextResponse.json({error:"Experience not found"},{status:404});return s.NextResponse.json({experience:e})}catch(e){return console.error("Get experience by ID error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}async function l(e,{params:r}){try{let t=e.cookies.get("auth-token")?.value;if(!t||!(0,c.WX)(t))return s.NextResponse.json({error:"Unauthorized"},{status:401});let n=await e.json();if(!await (0,u.Yb)(r.id,n))return s.NextResponse.json({error:"Experience not found or update failed"},{status:404});return s.NextResponse.json({success:!0})}catch(e){return console.error("Update experience error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}async function x(e,{params:r}){try{let t=e.cookies.get("auth-token")?.value;if(!t||!(0,c.WX)(t))return s.NextResponse.json({error:"Unauthorized"},{status:401});if(!await (0,u.Uk)(r.id))return s.NextResponse.json({error:"Experience not found or deletion failed"},{status:404});return s.NextResponse.json({success:!0})}catch(e){return console.error("Delete experience error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let f=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/experiences/[id]/route",pathname:"/api/experiences/[id]",filename:"route",bundlePath:"app/api/experiences/[id]/route"},resolvedPagePath:"/workspace/apps/web/app/api/experiences/[id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:w,staticGenerationAsyncStorage:v,serverHooks:y}=f,N="/api/experiences/[id]/route";function j(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:v})}},105:(e,r,t)=>{t.d(r,{Qj:()=>c,RA:()=>d,WX:()=>p});var n=t(63337),o=t(57772),i=t.n(o),a=t(41207),s=t.n(a);let u=process.env.JWT_SECRET||"dev-secret-key";async function c(e,r){let t=(await (0,n.N)()).collection("admins"),o=await t.findOne({email:e});return o&&await i().compare(r,o.password)?{...o,_id:o._id.toString()}:null}function d(e){let r={expiresIn:process.env.JWT_EXPIRES_IN||"7d"};return s().sign({adminId:e},u,r)}function p(e){try{return{adminId:s().verify(e,u).adminId}}catch{return null}}},23347:(e,r,t)=>{t.d(r,{BJ:()=>a,E$:()=>i,JJ:()=>s,Uk:()=>c,Yb:()=>u});var n=t(63337),o=t(38013);async function i(){let e=(await (0,n.N)()).collection("experiences");return(await e.find({available:!0}).sort({createdAt:-1}).toArray()).map(e=>({...e,_id:e._id.toString()}))}async function a(e){let r=(await (0,n.N)()).collection("experiences"),t=await r.findOne({_id:new o.ObjectId(e)});return t?{...t,_id:t._id.toString()}:null}async function s(e){let r=(await (0,n.N)()).collection("experiences"),t=new Date,o={...e,available:e.available??!0,createdAt:t,updatedAt:t},i=await r.insertOne(o);return{...o,_id:i.insertedId.toString()}}async function u(e,r){let t=(await (0,n.N)()).collection("experiences");return(await t.updateOne({_id:new o.ObjectId(e)},{$set:{...r,updatedAt:new Date}})).modifiedCount>0}async function c(e){let r=(await (0,n.N)()).collection("experiences");return(await r.deleteOne({_id:new o.ObjectId(e)})).deletedCount>0}},63337:(e,r,t)=>{t.d(r,{N:()=>s});var n=t(38013);let o=process.env.MONGODB_URI,i={},a=null;async function s(){return(await function(){if(!o)throw Error("Please define the MONGODB_URI environment variable");return a||(a=new n.MongoClient(o,i).connect()),a}()).db("kayo")}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[483,592,242],()=>t(31861));module.exports=n})();