"use strict";(()=>{var e={};e.id=243,e.ids=[243],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},22273:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>y,patchFetch:()=>m,requestAsyncStorage:()=>v,routeModule:()=>w,serverHooks:()=>N,staticGenerationAsyncStorage:()=>x});var n={};t.r(n),t.d(n,{DELETE:()=>f,GET:()=>l,PUT:()=>p,runtime:()=>d});var a=t(37260),o=t(71827),i=t(2150),s=t(80643),u=t(97275),c=t(105);let d="nodejs";async function l(e,{params:r}){try{let e=await (0,u.Q6)(r.id);if(!e)return s.NextResponse.json({error:"Aircraft not found"},{status:404});return s.NextResponse.json({aircraft:e})}catch(e){return console.error("Get aircraft by ID error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}async function p(e,{params:r}){try{let t=e.cookies.get("auth-token")?.value;if(!t||!(0,c.WX)(t))return s.NextResponse.json({error:"Unauthorized"},{status:401});let n=await e.json();if(!await (0,u.NM)(r.id,n))return s.NextResponse.json({error:"Aircraft not found or update failed"},{status:404});return s.NextResponse.json({success:!0})}catch(e){return console.error("Update aircraft error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}async function f(e,{params:r}){try{let t=e.cookies.get("auth-token")?.value;if(!t||!(0,c.WX)(t))return s.NextResponse.json({error:"Unauthorized"},{status:401});if(!await (0,u.kd)(r.id))return s.NextResponse.json({error:"Aircraft not found or deletion failed"},{status:404});return s.NextResponse.json({success:!0})}catch(e){return console.error("Delete aircraft error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let w=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/aircraft/[id]/route",pathname:"/api/aircraft/[id]",filename:"route",bundlePath:"app/api/aircraft/[id]/route"},resolvedPagePath:"/workspace/apps/web/app/api/aircraft/[id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:v,staticGenerationAsyncStorage:x,serverHooks:N}=w,y="/api/aircraft/[id]/route";function m(){return(0,i.patchFetch)({serverHooks:N,staticGenerationAsyncStorage:x})}},97275:(e,r,t)=>{t.d(r,{NM:()=>u,Q6:()=>i,Z8:()=>s,hd:()=>o,kd:()=>c});var n=t(63337),a=t(38013);async function o(e){let r=(await (0,n.N)()).collection("aircraft"),t={sort:{createdAt:-1}};return e&&(t.limit=e),(await r.find(e?{available:!0}:{},t).toArray()).map(e=>({...e,_id:e._id.toString()}))}async function i(e){let r=(await (0,n.N)()).collection("aircraft"),t=await r.findOne({_id:new a.ObjectId(e)});return t?{...t,_id:t._id.toString()}:null}async function s(e){let r=(await (0,n.N)()).collection("aircraft"),t=new Date,a={...e,available:e.available??!0,createdAt:t,updatedAt:t},o=await r.insertOne(a);return{...a,_id:o.insertedId.toString()}}async function u(e,r){let t=(await (0,n.N)()).collection("aircraft");return(await t.updateOne({_id:new a.ObjectId(e)},{$set:{...r,updatedAt:new Date}})).modifiedCount>0}async function c(e){let r=(await (0,n.N)()).collection("aircraft");return(await r.deleteOne({_id:new a.ObjectId(e)})).deletedCount>0}},105:(e,r,t)=>{t.d(r,{Qj:()=>c,RA:()=>d,WX:()=>l});var n=t(63337),a=t(57772),o=t.n(a),i=t(41207),s=t.n(i);let u=process.env.JWT_SECRET||"dev-secret-key";async function c(e,r){let t=(await (0,n.N)()).collection("admins"),a=await t.findOne({email:e});return a&&await o().compare(r,a.password)?{...a,_id:a._id.toString()}:null}function d(e){let r={expiresIn:process.env.JWT_EXPIRES_IN||"7d"};return s().sign({adminId:e},u,r)}function l(e){try{return{adminId:s().verify(e,u).adminId}}catch{return null}}},63337:(e,r,t)=>{t.d(r,{N:()=>s});var n=t(38013);let a=process.env.MONGODB_URI,o={},i=null;async function s(){return(await function(){if(!a)throw Error("Please define the MONGODB_URI environment variable");return i||(i=new n.MongoClient(a,o).connect()),i}()).db("kayo")}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[483,592,242],()=>t(22273));module.exports=n})();